---
# ============================================================================
# Caddy: Lab Configuration
# File: group_vars/n8n/caddy.yml
# Role: caddy (custom)
# ============================================================================
#
# Lab environment configuration for Caddy reverse proxy.
# Proxies external HTTPS traffic to n8n container.
#
# Variable precedence:
#   all < db < n8n (this file) < host_vars
#
# ============================================================================

# --- Let's Encrypt Contact Email ---
# Required by Caddy even for self-signed lab configs
# Production should use real email for certificate notifications
caddy_email: "test@domain.com"

# --- Caddy Sites Configuration ---
caddy_sites:
  - domain: "n8n.lab.local"
    backend: "localhost:{{ n8n_port }}"
    tls: internal

# ============================================================================
# Notes:
# - Lab configuration uses Caddy internal CA (tls internal)
# - Caddy listens on 443 (HTTPS) and redirects 80 â†’ 443
# - Backend points to n8n container port (internal HTTP)
# - Domain must be in /etc/hosts: 127.0.0.1 n8n.lab.local
# - Browser will show security warning (Caddy Local Authority cert)
# - Run 'caddy trust' on VM if curl health checks fail on HTTPS
# ============================================================================
