---
# ============================================================================
# PostgreSQL: Service Configuration
# File: group_vars/db/postgresql.yml
# Role: anxs.postgresql
# ============================================================================
#
# This file contains service-level configuration for all database hosts.
#
# Applied to: All hosts in 'db' group
# Variable precedence: Overrides all/, overridden by hw_*/ → app/ → host_vars/
# ============================================================================

# --- ROLE: Version ---
postgresql_version: 17

# --- ROLE: Server-wide Encoding and Locale ---
# References postgresql_defaults.server from group_vars/all/
postgresql_encoding: "{{ postgresql_defaults.server.encoding }}"
postgresql_locale: "{{ postgresql_defaults.server.locale }}"
postgresql_ctype: "{{ postgresql_defaults.server.ctype }}"

# --- ROLE: Data Directory ---
# References postgresql_defaults.paths from group_vars/all/
postgresql_data_directory: "{{ postgresql_defaults.paths.data_directory }}"

# --- ROLE: Network Configuration ---
postgresql_listen_addresses: "localhost"
postgresql_port: 5432

# --- ROLE: Authentication ---
postgresql_auth_method: "scram-sha-256"

# --- ROLE: Logging ---
postgresql_logging_collector: on
postgresql_log_directory: "log"
postgresql_log_filename: "postgresql-%a.log"
postgresql_log_rotation_age: "1d"
postgresql_log_rotation_size: 0
postgresql_log_truncate_on_rotation: on

# --- ROLE: Connection Limits ---
postgresql_max_connections: 100

# --- ROLE: Service State ---
postgresql_service_state: "started"
postgresql_service_enabled: yes
