---
# PostgreSQL Global Configuration
# Contains only justified overrides of PostgreSQL defaults

# Security: Always use modern authentication
postgresql_auth_method: "scram-sha-256"

# Service Management: Use reload instead of restart
postgresql_restarted_state: "reloaded"

# Performance Configuration
postgresql_global_config_options:
  # Required by geerlingguy.postgresql role
  - option: unix_socket_directories
    value: '{{ postgresql_unix_socket_directories | join(",") }}'
  - option: log_directory
    value: "log"

  # Memory: Increase shared_buffers from conservative default
  - option: shared_buffers
    value: "256MB" # Default: 128MB (too low for modern hardware)

  # WAL: Increase from defaults for better performance
  - option: wal_buffers
    value: "16MB" # Default: auto (max 16MB, make explicit)
  - option: min_wal_size
    value: "1GB" # Default: 80MB (too small)
  - option: max_wal_size
    value: "4GB" # Default: 1GB (increase for better checkpoints)

  # I/O: Minimal improvement for HDD systems
  - option: effective_io_concurrency
    value: "2" # Default: 1 (even HDDs benefit)
